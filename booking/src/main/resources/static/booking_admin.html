<!DOCTYPE html>
<html lang="ko">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>SBT 예약 관리</title>

    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.min.css" rel="stylesheet">
    
    <style>
    	.disabled {
            pointer-events: none;
            opacity: 0.6;
        }
        
        th{
        	text-align: center;
        }

    </style>
    
    <script type="text/javascript" src="js/jquery-3.5.1.js"></script>
	<script type="text/javascript" src="js/jquery-ui.min.js"></script>
	<script type="text/javascript" src="js/ui-common.js"></script>
    <script>
    	$(document).ready(function () {
	        console.log("admin popup~");
	        getBookingList();
		});
    	
    	function getBookingList(){
	        var data = new Object();
	        data.testString = "meeting list test!!";	
	        console.log(data);
		        
	        $.ajax({
	            url: "/getBookingList",
	            method: 'POST',
	            data: data,
	            dataType: 'json',
	            success: function (responseData) {
	                //alert('조회 성공');
	                console.log(responseData.length);
	                
	                if (responseData.length != 0) {
                        window.bookingData = responseData;
                        console.log(window.bookingData[0]);

						drawBookingTable('bookingListDiv', 'dataTable');
                    }
                    else {
                        alert('예약이 없습니다');
                    }
	
	            },
	            error: function () {
	                alert('조회 실패');
	            }
	        });
	    }
    	
    	function deleteBooking(seq) {
    		var data = String(seq);
    		$.ajax({
	            url: "/deleteBooking/" + seq,
	            method: 'GET',
	            dataType: 'json',
	            success: function (responseData) {
	                alert('삭제 성공');
	                getBookingList();
	            },
	            error: function () {
	                alert('삭제 실패');
	            }
	        });
    	}
    	
		function editBookingButton(seq) {
			console.log(seq);
    	}
    	
    	function drawBookingTable(result_area, table_id) {
            var htmlStart =
                `
            <table class="table table-bordered" id="dataTable" style="width:100%" cellspacing="0">
                        <thead>
                        <tr>
                        	<th style="width:6%">번호</th>
                            <th style="width:10%">회사</th>                           
                            <th style="width:10%">회의실</th>
                            <th style="width:15%">시작시간</th>
                            <th style="width:15%">종료시간</th>
                            <th style="width:10%">예약자</th>
                            <th>참석자</th>
                            <th>주제</th>
                            <th>관리</th>
                        </tr>
                        </thead>
                        <tbody>
            `;

            for (var i = 0; i < window.bookingData.length; i++) {

                var htmlContents =
                    `
                    <tr>
                		<td>` + window.bookingData[i].seq + `</td>
                        <td>` + window.bookingData[i].company + `</td>
                        <td>` + window.bookingData[i].room + `</td>
                        <td>` + window.bookingData[i].stdate + " " + window.bookingData[i].sttime + `</td>
                        <td>` + window.bookingData[i].eddate + " " + window.bookingData[i].edtime + `</td>
                        <td>` + window.bookingData[i].booking_human + `</td>
                        <td>` + window.bookingData[i].participant + `</td>
                        <td>` + window.bookingData[i].subject + `</td>
                        <td> <a href="#" class="btn btn-info btn-circle" onClick='editBookingButton(`+ window.bookingData[i].seq +`)'>
		                        <i class="fas fa-info-circle"></i>
		                     </a>
	                         <a href="#" class="btn btn-danger btn-circle" onClick='deleteBooking(`+ window.bookingData[i].seq +`)'>
	                            <i class="fas fa-trash"></i>
	                         </a> 
                        </td>
                    </tr>
                `;
                htmlStart = htmlStart + htmlContents;
            }

            var htmlEnd =
                `
                </tbody>
            </table>
            `;

            document.getElementById(result_area).innerHTML = htmlStart + htmlEnd;
        }
    	
    </script>

</head>

<body class="bg-gradient-primary">

    <div class="container">

        <div class="card o-hidden border-0 shadow-lg my-5">
            <div class="card-body p-0">
                <!-- Nested Row within Card Body -->
                <div class="row">
                    <div class="col-lg-12">
                        <div class="p-5">
                            <div class="text-left" style="float:left">
                                <h1 class="h4 text-gray-900 mb-4">예약 관리</h1>
                            </div>				
                        </div>
                        
                        <hr>
                        
                        <div class="p-5">
                        	<div class="table-responsive" id="bookingListDiv">
                                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                                    <thead>
                                        <tr>
                                        	<th style="width:6%">번호</th>
                                            <th style="width:10%">회사</th>                           
				                            <th style="width:10%">회의실</th>
				                            <th style="width:15%">시작시간</th>
				                            <th style="width:15%">종료시간</th>
				                            <th style="width:10%">예약자</th>
				                            <th>참석자</th>
				                            <th>주제</th>
				                            <th>관리</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td> 　</td>
		                                    <td> </td>
		                                    <td> </td>
		                                    <td> </td>
		                                    <td> </td>
		                                    <td> </td>
		                                    <td> </td>
		                                    <td> </td>
		                                    <td> </td>
                                        </tr>
                                        
                                    </tbody>
                                </table>
                            </div>
                        </div>
						
                    </div>
                </div>
            </div>
        </div>


    </div>

    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>

</body>

</html>